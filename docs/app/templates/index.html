<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoDocument</title>
    <link href="{{ url_for('static', filename='output.css') }}" rel="stylesheet">
    <script src="{{ url_for('static', filename='htmx.js') }}"></script>
</head>

<body class="bg-gray-100 font-sans">
    <header class="bg-blue-600 text-white">
        <div class="container mx-auto px-4 py-4">
            <h1 class="text-3xl font-bold">AutoDocument(ation)</h1>
        </div>
    </header>

    <div class="grid grid-cols-7">

        <div class="col-span-1 self-start sticky top-0 justify-between border-e bg-white  h-screen">
            {% include 'side-menu.html' %}
        </div>

        <div class="col-span-6 flex-1 p-6 space-y-6">
            <h1 class="text-4xl font-bold">Overview</h1>

            <p>Welcome to AutoDocument.</p>

            <p>Autodocument links various types of data sources - like Forms, Excel documents and SQL Queries, and
                outputs Documents like Microsoft Word, PDF or even text files. Create Workflows and link them to your
                users.</p>

            <p class="font-bold text-xl">Features</p>

            <div class="flow-root">
                <dl class="-my-3 divide-y divide-gray-200">
                    <div class="grid grid-cols-1 gap-1 py-3 sm:grid-cols-3 sm:gap-4">
                        <dt class="font-bold text-gray-900">Powerful Templating</dt>
                        <dd class=" sm:col-span-2">More than just inserting values into fields, leverage
                            tools like if and while statements to delete or loop through blocks of text.</dd>
                    </div>

                    <div class="grid grid-cols-1 gap-1 py-3 sm:grid-cols-3 sm:gap-4">
                        <dt class="font-bold text-gray-900">Data Splitting</dt>
                        <dd class=" sm:col-span-2">Use Data Sources with multiple records to split the
                            workflow, like generating a PDF for each line in a spreadsheet.</dd>
                    </div>

                    <div class="grid grid-cols-1 gap-1 py-3 sm:grid-cols-3 sm:gap-4">
                        <dt class="font-bold text-gray-900">Customised Forms</dt>
                        <dd class=" sm:col-span-2">Add HTML forms to kick off a Workflow</dd>
                    </div>

                    <div class="grid grid-cols-1 gap-1 py-3 sm:grid-cols-3 sm:gap-4">
                        <dt class="font-bold text-gray-900">Data Source Chaining</dt>
                        <dd class=" sm:col-span-2">Data Sources are loaded in order, so the information
                            from one can be used in the next. See <a class="text-blue-600" href="{{ url_for('top.sources') }}">Sources</a> for more
                            info</dd>
                    </div>

                    <div class="grid grid-cols-1 gap-1 py-3 sm:grid-cols-3 sm:gap-4">
                        <dt class="font-bold text-gray-900">Saving File Options</dt>
                        <dd class=" sm:col-span-2">Download or upload on the fly, or read and write to
                            network filesystems, S3 or Sharepoint Libraries</dd>
                    </div>


                </dl>
            </div>

            <div class="py-5">
                <span class="flex items-center h-px flex-1 bg-black"></span>
            </div>

            <h1 class="text-4xl font-bold">Installation</h1>

            <p>AutoDocument is designed to be used in a container. Run with:</p>

            <p class="rounded bg-gray-800 p-1 text-gray-50"><code>docker run autodocument -p 4605:4605</code>
            </p>

            <p>AutoDocument works well with shared drives that are mounted in the container. If your shared drive is
                mounted on the host at <code>/mnt/shared_filesystem</code> then you can mount that to the AutoDocument
                container:</p>

            <p class="rounded bg-gray-800 p-1 text-gray-50"><code>docker run autodocument -p 4605:4605 -v
                    /mnt/shared_filesystem:/shared_filesystem</code></p>

                <p>See <a href="{{ url_for('top.file_storages') }}" class="text-blue-600">File Storages</a> for more info.</p>

            <p>You may also want to change the admin password, which is loaded from ADMIN_PASSWORD, and defaulted to
                "admin":</p>

            <p class="rounded bg-gray-800 p-1 text-gray-50"><code>docker run autodocument -p 4605:4605 -e
                    ADMIN_PASSWORD="MyPassword"</code></p>


            <div class="py-5">
                <span class="flex items-center h-px flex-1 bg-black"></span>
            </div>

            <h1 class="text-4xl font-bold">Quickstart</h1>

            <p>Once you've got a fresh installation of AutoDocument ready to go:</p>

            <h2 class="font-bold text-2xl">Tutorial 1: The Basics</h2>

            <p>We're going to ask the user for Name and Age and then populate a Word Document.</p>

            <p>AutoDocument uses repeatable Workflows. On the Home Screen create one called "Tutorial 1".</p>

            <p class="font-bold">Creating The Form</p>

            <p>Add the Name Field: Click on "Add Form Field"</p>
            <p>the Name of the field is the keyword that will be substituted later. Type "name"</p>
            <p>The Label of the field is what the user will see on the Form. Type "Client's Name"</p>
            <p>This is some text - so select "String" as the Data Type</p>

            <p>Add the Age Field: Click on "Add Form Field"</p>
            <p>the Name of the field is the keyword that will be substituted later. Type "age"</p>
            <p>The Label of the field is what the user will see on the Form. Type "Client's Age"</p>
            <p>Select "Number" as the Data Type</p>

            <p class="font-bold">Creating The Outcome</p>

            <p>If you have access to a Microsoft Word Document, then create a .docx file somewhere.</p>

            <p class="border rounded p-5"><code>Hi {{ '{{name}}' }}, your age is {{ '{{age}}' }}.</code></p>

            <p>(The double "Curly Braces", { and }, tell AutoDocument that it is a field. ")</p>

            <p>In AutoDocument, click "Add Microsoft Word" in the Outcomes Section.</p>

            <p>We need to select where the template is coming from and how the output will be saved. Because we haven't
                linked any File Storages yet, we will upload the template and download the output.</p>

            <p>Under Template, select "Uploaded during Workflow" with the Unique Name: "Template".</p>

            <p>Under Output File, select Downloaded after Workflow with the output name: "{{ '{{name}}' }}.docx" (Yes,
                field substitutions work in file names!)</p>

            <p>Submit</p>

            <p>Our Workflow is ready to go!</p>

            <p class="font-bold">Running the Workflow</p>

            <p>Click Run on the workflow page. We are asked for the Client's Name and Age. Fill in some details like
                "Bob" aged 25. We also need to upload our Word Document from before. Hit Submit.</p>

            <p>All going well, you should have downloaded a "output.zip" file, which when extracted has a <span
                    class="font-bold">Bob.docx</span> (or <span class="font-bold">Bob.txt</span>) file in it. Open it to
                see the fields have been replaced with the values supplied on the form!</p>

            <div class="py-5">
                <span class="flex items-center h-px flex-1 bg-black"></span>
            </div>

            <h2 class="font-bold text-2xl">Tutorial 2: Multi Record Sources</h2>

            <p>AutoDocument shines with Workflows that "Split" with Multi Record Sources, like a .csv with many records.
                We will create a workflow with a CSV file with 3 records in it, and generate a Word Document for each
                record.
            </p>

            <p>Create a new Workflow called Tutorial 2</p>

            <p>Click: Add a CSV Table. A MultiRecord Source like a CSV Table can either be used as a "Splitter", where
                the Workflow will spawn multiple child Workflows that will calculate their Outcomes seperatly, or as a
                "Field", where the multiple records are attached to a field name, and can be looped over in a template.
            </p>

            <p>Check "Splitter".</p>

            <p>We will upload the csv when we run the Workflow, simliar to Tutorial 1. Choose "Uploaded during Workflow"
                and set the Unique Name as "Client Records". Submit.</p>

            <p>Somewhere, create a .csv file with some records that can populate the same Word Document as Tutorial 1.
                For example:</p>

            <p><code>ClientRecords.csv:</code></p>

            <div class="overflow-x-auto">
                <table class="min-w-max divide-y-2 divide-gray-200 bg-white text-sm rounded">
                    <thead class="ltr:text-left">
                        <tr>
                            <th class="font-bold whitespace-nowrap px-4 py-2 text-gray-900">name</th>
                            <th class="font-bold whitespace-nowrap px-4 py-2 text-gray-900">age</th>
                        </tr>
                    </thead>

                    <tbody class="divide-y divide-gray-200">
                        <tr>
                            <td class="whitespace-nowrap px-4 py-2 font-medium text-gray-900">John Doe</td>
                            <td class="whitespace-nowrap px-4 py-2 text-gray-700">48</td>
                        </tr>

                        <tr>
                            <td class="whitespace-nowrap px-4 py-2 font-medium text-gray-900">Jane Doe</td>
                            <td class="whitespace-nowrap px-4 py-2 text-gray-700">35</td>
                        </tr>

                        <tr>
                            <td class="whitespace-nowrap px-4 py-2 font-medium text-gray-900">Alice Bob</td>
                            <td class="whitespace-nowrap px-4 py-2 text-gray-700">28</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <p>Now we can add the Microsoft Word Outcome again. Click "Add Microsoft Word". Choose "Uploaded during
                Workflow" with a Unique Name of "Template", and Output File of "Downloaded after Workflow" with an
                Output Name of "{{ '{{name}}' }}.docx"</p>

            <p>When we run the Workflow now, we will download an output.zip file with 3 Word documents - one for each
                record.</p>

            <h2 class="font-bold text-2xl">Tutorial 3: Source Chaining - Example</h2>

            <p>You can construct advanced Workflows by chaining sources together. This tutorial is more difficult to
                follow along because it assumes some infrastructure setup. But it demonstrates as an example the kinds
                of thing you can do with AutoDocument.</p>

            <p>Lets say you had 3 classes of clients: A, B and C. And you wanted to generate invoices for each client
                within a category from a database. Each Invoice has a list of items that have been ordered, which we
                want listed in the invoice. We want to save each invoice in the client's folder on a shared Windows
                Drive called N:</p>

            <p class="font-bold">Setup</p>

                <p>We will assume we have a Database connected, called "Business Database" (see <a href="{{ url_for('top.databases') }}"
                    class="text-blue-600">Databases</a> for more info).</p>

            <p>We also assume we have a Windows File Storage set up (see <a href="{{ url_for('top.file_storages') }}" class="text-blue-600">File
                    Storages</a> for more info)</p>

            <p>Step 1 after creating the Workflow is to ask the user what category of Client. So we'll add a form with a
                name of "category", a label of "Client Category" and datatype of String.</p>

            <p>Next we'll get a list of clients from our database using the answer to the "Category" question in the
                form.</p>

            <p>If we add a SQL RecordSet, we can use an example query like:</p>

            <p class="rounded bg-gray-800 p-1"><code class="text-gray-50">SELECT client_id, client_name from Client
                    where category = :category</code></p>

            <p>The :category in the query tells AutoDocument to insert the value for "category" from any previous Source
                into the query. (It is also safe from SQL injection). We'll set it as a splitter, and leave it as Step
                1.</p>

            <p>This Workflow now splits for each record in this recordset, and will have the value "category", and one
                set of client_id and client_name in each Workflow.</p>

            <p>We can use those values for the next step: another recordset. This time the query could be something
                like:</p>

            <p class="rounded bg-gray-800 p-1"><code class="text-gray-50">SELECT item_name, quantity from ItemOrder
                    where client_id = :client_id</code></p>


            <p>(Yes we could have used an inner join to just use one query but lets assume we can't.)</p>

            <p>Note, each Workflow split from the original will have a different client_id, which has been sourced from
                the first query.</p>

            <p>This time we aren't splitting the Workflow, because we want all the item details to be shown on the one
                invoice. Instead, we'll set the Field Name to be "items" and keep splitter unchecked. Now the results of
                this query will be saved as a list inside "items".</p>

            <p>Make sure we set this query to Step 2, because it realies on data from a source within Step 1
                (client_id).</p>

            <p>We can loop through those items in a template like this:</p>

            <div class="rounded bg-gray-200 p-1">
                Hi {{ '{{ client_name }}' }},
                <br>
                <br>

                Here is your invoice for your purchase of items:
                <br>
                <br>
                {{ '{% for item in items %}' }}
                <br>
                {{ "{{ item['quantity'] }}" }} units of {{ "{{ item['item_name'] }}" }}.
                <br>
                {{ '{% endfor %}' }}
            </div>

            <p>Now when we add our Microsoft Word document outcome lets use the Windows Share we setup previously. We'll
                set the template to be something like "Templates\InvoiceTemplate.docx"</p>

            <p>The Output File can use the client_id to build the path, something like
                "Invoices\{{client_id}}\Invoice.docx", which would render to something like
                "\Invoices\123456\Invoice.docx"</p>

            <p>We now have a repeatable Workflow that can generate all the Invoices for each client category.</p>
        </div>

    </div>
</body>

</html>
